<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Harmony+ Wellness</title>
    <script src="assets/chart.umd.js"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link href="./output.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: "Montserrat", sans-serif;
        }
    </style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="w-[640px] h-[960px] bg-white rounded-xl shadow-md overflow-hidden flex flex-col">
        <!-- Header -->
        <div class="flex items-center justify-between px-4 py-3 border-b">
            <h1 class="text-xl font-bold text-green-700">Harmony+</h1>
            <button class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M5.121 17.804A8.966 8.966 0 0112 15c2.285 0 4.355.876 5.879 2.304M15 10a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            </button>
        </div>

        <div class="p-4 flex-1 flex flex-col">
            <h2 class="text-lg font-semibold text-[#333333] mb-4">Meal Log</h2>

            <!-- Previously Logged Meals -->
            <div id="meal-log" class="flex flex-col space-y-4 mb-4">
                <!-- Logged Meal Card -->
                <div class="bg-[#FFF8E1] p-3 rounded-lg">
                    <h3 class="font-semibold text-[#333333]">Breakfast</h3>
                    <p class="text-sm text-[#777777]">
                        Calories: 250 â€¢ Portion Size: S
                      </p>
                      <p class="text-xs text-[#777777]">  Carbs: 5g â€¢ Protein: 9g â€¢ Fat: 3g </p>
                    <p class="text-xs text-[#777777]">Yogurt, Granola</p>
                </div>
                <!-- <div class="bg-[#FFF8E1] p-3 rounded-lg">
                    <h3 class="font-semibold text-[#333333]">Lunch</h3>
                    <p class="text-sm text-[#777777]">Protein: 17g â€¢ Portion Size: M</p>
                    <p class="text-xs text-[#777777]">Chicken Salad, Veggie Wrap</p>
                </div>
                <div class="bg-[#FFF8E1] p-3 rounded-lg">
                    <h3 class="font-semibold text-[#333333]">Dinner</h3>
                    <p class="text-sm text-[#777777]">Carbs: 20g â€¢ Portion Size: L</p>
                    <p class="text-xs text-[#777777]">Pasta, Steamed Veggies</p>
                </div> -->

            </div>

            <button 
            class="bg-[#4C9F70] text-white py-1.5 px-3 rounded-md text-xs font-medium hover:bg-green-700 mb-10 self-start"
            onclick="window.location.href='allmeals.html'">
            View More and Edit
          </button>

            <!-- Chart Section -->
            <div class="grid grid-cols-2 gap-5 mb-2">
                <div class="bg-gray-50 p-2 rounded shadow-sm">
                    <h3 class="text-xs font-medium text-gray-600 mb-1 text-center">Calories (7 Days)</h3>
                    <div class="bg-gray-50 px-3 py-2 rounded shadow-sm flex items-center justify-center h-[120px]">
                        <canvas id="calorieChart" class="w-full max-w-[200px] h-[200px]"></canvas>
                      </div>
                      
                </div>
                <div class="bg-gray-50 p-2 rounded shadow-sm">
                <h3 class="text-xs font-medium text-gray-600 mb-1 text-center">Macro Split</h3>
                <div class="bg-gray-50 px-3 py-2 rounded shadow-sm flex items-center justify-center h-[120px]">
                    <canvas id="macroChart" class="w-full max-w-[150px] h-[200px]"></canvas>
                  </div>
                  
                </div>
            </div>

            <div class="bg-green-50 p-2 rounded-lg shadow-sm mb-4">
                <h3 class="text-sm font-semibold text-green-800 mb-2">Healthy Meal Suggestion</h3>
                <p class="text-sm text-gray-800 font-medium">ðŸ¥£ Greek Yogurt Bowl</p>
                <p class="text-xs text-gray-600 mb-1">300 kcal â€¢ 25g protein â€¢ 20g carbs â€¢ 8g fat</p>
                <p class="text-xs text-gray-500 mb-3">Greek yogurt topped with granola and berries</p>
                <button 
                  class="bg-[#4C9F70] text-white text-xs px-3 py-1 rounded hover:bg-green-700"
                  onclick="window.location.href='meallibrary.html'">
                  Browse More Meals â†’
                </button>
            </div>

            <!-- Enter Meal Button -->
            <button class="mt-auto bg-[#4C9F70] text-white py-2.5 rounded-lg text-sm font-semibold" onclick="window.location.href='addmeal.html'">
                Enter Meal
            </button>
        </div>

        

        <!-- Navigation Bar --> 
        <div class="flex justify-between items-center px-4 py-2 border-t">
            <a href="mobilehome.html" class="flex flex-col items-center text-gray-500 hover:text-green-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3 9.75l7.5-6 7.5 6v9.75a1.5 1.5 0 01-1.5 1.5h-3.75a.75.75 0 01-.75-.75v-4.5H9.75v4.5a.75.75 0 01-.75.75H5.25a1.5 1.5 0 01-1.5-1.5V9.75z" />
                </svg>
                <span class="text-xs font-medium">Home</span>
            </a>
            <a href="activity.html" class="flex flex-col items-center text-gray-500 hover:text-green-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <span class="text-xs font-medium">Activity</span>
            </a>
            <a href="nutrition.html" class="flex flex-col items-center text-green-700">
                <svg class="h-6 w-6 mb-0.5" fill="currentColor" viewBox="-3.33 0 100.001 100.001"
                    xmlns="http://www.w3.org/2000/svg">
                    <path id="apple"
                        d="M588.106,980.092c-5.088-1.758-8.444-5.249-12.385-8.156-1.628-2.1-3.4-4.055-5.137-6.042-1.785-1.841-2.845-4.4-4.23-6.646a44.835,44.835,0,0,1-4.529-17.223V929.641c.136-1.371.542-2.479.6-3.928-.714-.083.346-.806.3-1.208-.218-.925.52-.89.3-1.814a16.835,16.835,0,0,0,1.212-3.321,10.719,10.719,0,0,0,1.206-3.02,2.8,2.8,0,0,0,1.207-1.814c.52-.389,1.19-.625,1.21-1.512,1.2-.713,1.795-2.03,2.718-3.019a69.073,69.073,0,0,1,18.43-9.065,47.789,47.789,0,0,1,14.2,1.51c-2.134-5.923-7.571-8.542-10.271-13.9-.2-1.307.524-1.7.908-2.417.565.01.584-.524.6-1.058s.039-1.071.607-1.058c2.742-.328,3.19,1.641,4.83,2.417,1.213,1.2,2,2.834,3.322,3.926a31.731,31.731,0,0,1,8.459-8.76A7.064,7.064,0,0,0,615,881c.987.012,1.993.008,3,0,4.254-.018,8.508-.035,11.5,1.205,1.158,4.693-1.63,7.755-2.417,11.481-1.175,1.138-1.945,2.687-3.019,3.927-1.3,1.013-2.529,2.106-3.929,3.02-3.695.741-7.974.086-11.179-.6.059,1.352.328,2.49,1.209,3.02.661.649,2.475.143,3.024.907a68.941,68.941,0,0,0,6.946-1.209h11.482a43.231,43.231,0,0,1,9.362,3.023,58.091,58.091,0,0,1,6.953,5.135c1.75,2.879,3.765,5.5,4.83,9.063,1.354,3.277,1.91,7.355,2.417,11.48v12.69a45.968,45.968,0,0,1-4.231,14.2c-1.591,4.549-4.82,7.466-7.247,11.178-2.193,1.43-3.924,3.329-6.046,4.833-1.947,1.578-4.5,2.545-6.643,3.929-1.932.385-4.236.4-5.742,1.208a11.478,11.478,0,0,1-2.72-.606c-.343.765-1.337.878-2.416.907-.2-.9-2.02-.2-2.117-1.21a1.4,1.4,0,0,1-1.129-.461,1.39,1.39,0,0,0-1.287-.445,8.057,8.057,0,0,0-5.437-1.21c-2.531.591-4.254,1.989-6.043,3.325-1.819-.108-2.476.946-3.925,1.209C596.191,980.673,591.641,980.891,588.106,980.092Zm7.553-10.27c1.6.6,1.081,2.451.907,4.229a3.9,3.9,0,0,0,2.079-.616,3.775,3.775,0,0,1,2.454-.592c.755-1.257.944-3.083,3.018-3.021.581-.027.744.364.908.754s.327.781.908.756c2.921-.375,6.414-1.539,9.664-.6a6.258,6.258,0,0,1,2.722-.906,18.153,18.153,0,0,1,3.324.6h3.32c2.885-.841,6.31-1.143,9.067-2.115a32.571,32.571,0,0,0,5.134-4.833,5.66,5.66,0,0,1,.3-2.415c2.661-3.082,5.457-6.028,6.345-10.878.279-2.541,1.111-4.529,1.509-6.949a78.209,78.209,0,0,1,.906-7.855c-1.086-5.256-2.6-10.091-2.416-16.616a9.677,9.677,0,0,1-.6-3.02c-.86-.551-1.1-1.719-2.119-2.116-.087-.616-.816-.594-.9-1.209-.373.041-.448-.214-.524-.47-.085-.289-.17-.578-.687-.436a33.6,33.6,0,0,0-11.176-4.229,43.368,43.368,0,0,1-4.568-.166,24.951,24.951,0,0,0-7.217.166c-1.022.185-.482,1.932-1.812,1.814a7.191,7.191,0,0,1-2.193-.16,6.97,6.97,0,0,0-2.339-.143c-.435.976-.284,2.534-.3,3.929,2.275.058,3.32-1.113,5.437-1.21a4.763,4.763,0,0,1,3.929-1.813,2.44,2.44,0,0,1,1.81,2.114,6.781,6.781,0,0,1-1.81,3.929c-3.178,1.151-6.337,2.326-9.671,3.321h-7.854c-1.517-.493-3.386-.642-4.53-1.508-1.692-.323-3.181-.846-3.325-2.72.055-1.614,1.77-1.569,3.484-1.524.354.009.708.018,1.049.013a13.735,13.735,0,0,0,5.436.3c-.087-1.826.243-4.07-.3-5.437-2.739-.747-6.292-.677-9.846-.607-1.786.035-3.573.07-5.256,0-1.519.3-3.009.618-4.533.907-.4.5-1.345.47-1.814.908-.636.266-.894.916-1.812.9-1.872,1.756-4.982,2.269-6.042,4.836,1.775-.266,2.737.282,3.022,1.508-.044,2.074-1.4,2.829-1.815,4.531a29.279,29.279,0,0,0-1.812,4.837c.372.374.716.232,1.157.089a2.132,2.132,0,0,1,1.259-.089c.345.665,1.009,1,1.211,1.814-.854.756-.959,2.263-1.815,3.019-.846,3.083-1.78,6.076-2.416,9.367.282,1.546-1.138,3.731.3,4.531.517-1.9.989-3.847,3.323-3.928.068.567.779,2,0,2.418a4.411,4.411,0,0,1-.6,2.719,10.641,10.641,0,0,1-.3,3.022c.426,1.249-.86,2.333,0,3.02.666-1.552.473-3.961,3.022-3.623.756,2.615-.166,6.041-.606,8.456.418.39.3,1.314.305,2.115-.5.606.024,2.24-.606,2.72.188.917-.386,2.6.3,3.02.56-2.26.9-4.744,3.928-4.531,1,.31,1.018,1.6,1.211,2.717.692-.192,1.819-.6,2.417,0,.164,1.147.729,1.889.6,3.326,1.126-.284,1.571-1.247,3.324-.908,1.153,2.133-.9,5.736.6,7.252.006-.5.839-.169.908-.6.7.093.335-.873.907-.905.388-.589.714-1.244,1.693-1.244A2.684,2.684,0,0,1,595.659,969.822Zm-25.375-34.441c-.163.659-.732,1.953.3,2.114-.481-.984,1.022-2.114-.26-2.114Zm37.76-44.108a2.793,2.793,0,0,1-.9,2.114c-.093.916-1.168.85-1.209,1.813,2.847,1.38,7.2,1.255,11.478,1.208,1.786-.936,2.7-2.735,4.232-3.927.4-2.417,2.227-3.409,2.417-6.043H613.483c-.636.269-.89.919-1.813.907C610.466,888.657,609.55,890.26,608.044,891.273ZM629.8,946.861c-.187-3.515-1.583-9.755,2.718-9.67,2.218,1.584,2.534,6.083,1.814,9.67-1.009,0-1.034.983-2.118.907a2.046,2.046,0,0,1-.321.027C630.882,947.8,630.778,946.894,629.8,946.861Zm7.552-13.6c.041-1.166,1.227-1.19,1.513-2.115,2.917.078,2.894,4.838,1.51,6.648a4.245,4.245,0,0,1-.591.044C637.447,937.843,637.471,935.483,637.35,933.266Zm-16.339.254c.076-2.209,1.634-4.419,4.558-3.577,1.429,1.992,1.52,5.932-.607,7.249a4.311,4.311,0,0,1-.844.088C621.959,937.28,620.948,935.4,621.012,933.52Z"
                        transform="translate(-561.825 -880.999)" />                
                    </svg>
                <span class="text-xs font-medium">Nutrition</span>
            </a>
            <a href="wellness.html" class="flex flex-col items-center hover:text-green-700">
                <svg class="h-6 w-6 mb-0.5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M20.16,5A6.29,6.29,0,0,0,12,4.36a6.27,6.27,0,0,0-8.16,9.48l6.21,6.22a2.78,2.78,0,0,0,3.9,0l6.21-6.22A6.27,6.27,0,0,0,20.16,5Zm-1.41,7.46-6.21,6.21a.76.76,0,0,1-1.08,0L5.25,12.43a4.29,4.29,0,0,1,0-6,4.27,4.27,0,0,1,6,0,1,1,0,0,0,1.42,0,4.27,4.27,0,0,1,6,0A4.29,4.29,0,0,1,18.75,12.43Z" />
                </svg>
                <span class="text-xs font-medium">Wellness</span>
            </a>
        </div>
    </div>


    <script>
        const mealLog = document.getElementById("meal-log");
        const allMeals = JSON.parse(localStorage.getItem("meals") || "[]");
        const meals = allMeals.slice(-3).reverse();

        meals.forEach(meal => {
        const card = document.createElement("div");
        card.className = "bg-[#FFF8E1] p-3 rounded-lg";
        card.innerHTML = `
            <h3 class="font-semibold text-[#333333]">${meal.type}</h3>
            <p class="text-sm text-[#777777]">
            Calories: ${meal.calories || "â€”"} â€¢ Portion Size: ${meal.portion}
            </p>
            <p class="text-xs text-[#777777]">
            Carbs: ${meal.carbs || 0}g â€¢ Protein: ${meal.protein || 0}g â€¢ Fat: ${meal.fat || 0}g
            </p>
            <p class="text-xs text-[#777777]">${meal.description}</p>
        `;
        mealLog.appendChild(card);
        });

        // Helpers
        function getDayLabel(date) {
        return date.toLocaleDateString(undefined, { weekday: 'short' });
        }
        function groupByDate(meals) {
        const map = {};
        meals.forEach(meal => {
            if (!meal.calories) return;
            const date = new Date(meal.date || meal.id);
            const key = date.toISOString().slice(0, 10);
            if (!map[key]) map[key] = 0;
            map[key] += meal.calories;
        });
        return map;
        }
        function getLastNDays(n) {
        const days = [];
        const now = new Date();
        for (let i = n - 1; i >= 0; i--) {
            const day = new Date();
            day.setDate(now.getDate() - i);
            const key = day.toISOString().slice(0, 10);
            days.push({ key, label: getDayLabel(day) });
        }
        return days;
        }

        // === Charts ===
        const calMap = groupByDate(allMeals);
        const last7Days = getLastNDays(7);
        const calLabels = last7Days.map(d => d.label);
        const calData = last7Days.map(d => calMap[d.key] || 0);

        let totalCarbs = 0, totalProtein = 0, totalFat = 0;
        allMeals.forEach(meal => {
        totalCarbs += meal.carbs || 0;
        totalProtein += meal.protein || 0;
        totalFat += meal.fat || 0;
        });

        new Chart(document.getElementById('calorieChart'), {
        type: 'line',
        data: {
            labels: calLabels,
            datasets: [{
            data: calData,
            borderColor: '#4C9F70',
            borderWidth: 1.5,
            pointRadius: 0,
            tension: 0
            }]
        },
        options: {
            responsive: false,
            plugins: {
            legend: { display: false },
            tooltip: { enabled: false }
            },
            scales: {
            x: {
                ticks: { font: { size: 8 } },
                grid: { display: false }
            },
            y: {
                beginAtZero: true,
                max: Math.max(calData),
                ticks: {
                font: { size: 8 },
                stepSize: 200
                },
                grid: { display: false }
            }
            }
        }
        });

        new Chart(document.getElementById('macroChart'), {
        type: 'doughnut',
        data: {
            labels: [`Carbs(${totalCarbs}g)`, `Protein(${totalProtein}g)`, `Fat(${totalFat}g)`],
            datasets: [{
            data: [totalCarbs, totalProtein, totalFat],
            backgroundColor: ['#60A5FA', '#F87171', '#FBBF24'],
            borderWidth: 0
            }]
        },
        options: {
            responsive: false,
            cutout: '65%',
            plugins: {
            legend: {
                position: 'right',
                labels: {
                font: { size: 10 },
                padding: 6,
                usePointStyle: true,
                pointStyle: 'circle'
                }
            },
            tooltip: { enabled: false }
            }
        }
        });

    </script>

</body>


</html>